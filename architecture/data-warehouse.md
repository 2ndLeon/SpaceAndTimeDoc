# 数据仓库

## 概述

数据仓库是Space and Time网络的骨干，便于数据的存储、更新和查询。它是一个分散的、Web3 原生的混合事务/分析处理 (HTAP) 引擎，可为任何数据工作负载实现去信任、可扩展性和闪电般的性能。

<figure><img src="https://1359882050-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FzHdDPR6NVKwyccJmuzAw%2Fuploads%2FJXbEXgFJpEinOqxpzjHi%2Fdata%20warehouse.png?alt=media&#x26;token=1fe72e1b-9b31-484f-9b64-b4aa4436704c" alt=""><figcaption><p><em>SxT 数据仓库架构</em></p></figcaption></figure>

## **集群**

**集群构成了 SxT 网络。**与传统的单节点数据库不同，SxT 集群由多个节点组成，允许集群跨节点分发数据。当用户查询位于不同节点上的数据时，节点会根据它们在本地存储的数据进行通信以并行执行查询片段。这种分布模型增加了可以存储的数据的数量和大小，并提高了对更大数据集的计算能力，将每个 SxT 集群从一个简单的数据库提升到一个强大的数据仓库。

## 核心数据仓库

### **数据引擎**

**SxT 采用 HTAP 引擎，加入了 OLTP 和 OLAP。**事务处理 (OLTP) 引擎负责快速事务查找，而分析处理 (OLAP) 引擎可以支持大量分析作业并回答大型分析问题，同时仍然实现低延迟响应时间。上图所示的 SQL 证明引擎是一个抽象，表示防篡改查询的处理方式不同：除了计算结果之外，引擎还必须生成一个加密哈希，允许外部验证器验证工作是否防篡改。

### 查询工作流程

用户请求首先到达 OLTP 引擎，该引擎解析每个请求以决定它应该在哪里执行。如果确定查询是事务性的，则 OLTP 会执行它。如果确定它是分析的，则将其传递给 OLAP。**此模型通过限制添加到 OLTP 请求的延迟来提供更好的性能保证。**

## 网络管理

\
**网络管理代表了整个网络的更大功能。**该组件与 Gateway Intelligence 协调——发送健康更新（心跳）和接收指令管理进出集群的数据。与数据引擎不同，这些服务不受 SQL 交互的直接影响。换句话说，用户编写的任何查询都与数据引擎交互，而网络管理服务由网关智能控制。

### 数据摄取

数据摄取是通过网关流组件传输的用户数据到达适当用户表的方式。

### WAN CDC

**WAN CDC 是提供冗余的关键部分，它允许理论上无限大、无限可用的集群。**复制网络中的所有数据以实现容错； WAN 变更数据捕获 (CDC) 支持这些副本的同步。对于用户编写的每个事务性命令，WAN CDC 会捕获正在更改的内容以及与命令关联的数据，并与数据副本共享。在主集群发生故障的情况下，立即切换到副本可确保不会丢失用户数据并且不会经历停机时间。

### 存档

**存档用作用户数据的冷存储。**除了 WAN CDC 的功能外，来自主集群的数据会不断写入持久的冷库存档。这些存档是永久的和冗余的，可以在任何灾难情况下可靠地恢复数据。
